<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ssic.catering.base.mapper.PageConfigExMapper" >
  
  <sql id="Example_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Nov 23 14:47:10 CST 2015.
    -->
    <where >
      <foreach collection="example.oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>

  <select id="selectPageConfigDtoBy" resultType="com.ssic.catering.base.dto.PageConfigDto">
  	select 
  		t1.id as id,
  		t1.cafetorium_id as cafetoriumId,
  		t1.project_id as projectId,
  		t1.name as name,
  		t1.is_enabled as isEnabled,
  		t1.enabled_url as enabledUrl,
  		t1.not_enabled_url as notEnabledUrl,
  		t1.create_time as createTime,
  		t1.last_update_time as lastUpdateTime,
  		t1.stat as stat,
  		t2.proj_name as projectName,
  		t3.cafe_name as cafetoriumName
  	from
  		t_ctr_page_config t1  		  		
  	LEFT JOIN
  		t_ims_project t2
  	ON
  		t1.project_id = t2.id
  	LEFT JOIN
  		t_ctr_cafetorium t3
  	ON
  		t1.cafetorium_id = t3.id
  		
  	<if test="example != null" >
      <where >
	      <foreach collection="example.oredCriteria" item="criteria" separator="or" >
	        <if test="criteria.valid" >
	          <trim prefix="(" suffix="" prefixOverrides="and" >
	            <foreach collection="criteria.criteria" item="criterion" >
	              <choose >
	                <when test="criterion.noValue" >
	                  and t1.${criterion.condition}
	                </when>
	                <when test="criterion.singleValue" >
	                  and t1.${criterion.condition} #{criterion.value}
	                </when>
	                <when test="criterion.betweenValue" >
	                  and t1.${criterion.condition} #{criterion.value} and #{criterion.secondValue}
	                </when>
	                <when test="criterion.listValue" >
	                  and t1.${criterion.condition}
	                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
	                    #{listItem}
	                  </foreach>
	                </when>
	              </choose>
	            </foreach>
	          </trim>
	        </if>
	      </foreach>
	      
	      <if test="increment != null">
	      	<choose>
	      		<when test="example.oredCriteria">
	      			<choose>
			      		<when test="increment.projectName != null and increment.projectName != '' ">
			      			and t2.proj_name like '%${increment.projectName}%'
		      				<choose>
		      					<when test="increment.cafetoriumName != null and increment.cafetoriumName != '' ">
		      						and t3.cafe_name like '%${increment.cafetoriumName}%'
		      					</when>		      					
		      				</choose>
			      		</when>
			      		<otherwise>
			      			<choose>
			      				<when test="increment.cafetoriumName != null and increment.cafetoriumName != '' ">
			      					t3.cafe_name like '%${increment.cafetoriumName}%'
			      				</when>
			      			</choose>
			      		</otherwise>
		      		</choose>
		      		 )
	      		</when>
	      		<otherwise>
		      		<choose>
			      		<when test="increment.projectName != null and increment.projectName != '' ">
			      			t2.proj_name like '%${increment.projectName}%'
		      				<choose>
		      					<when test="increment.cafetoriumName != null and increment.cafetoriumName != '' ">
		      						and t3.cafe_name like '%${increment.cafetoriumName}%'
		      					</when>		      					
		      				</choose>
			      		</when>
			      		<otherwise>
			      			<choose>
			      				<when test="increment.cafetoriumName != null and increment.cafetoriumName != '' ">
			      					t3.cafe_name like '%${increment.cafetoriumName}%'
			      				</when>
			      			</choose>
			      		</otherwise>
		      		</choose>
	      		</otherwise>
	      	</choose>
	      	
	      </if>
	     
      </where>
      
    </if>  		
  	<if test="example.orderByClause != null" >
     	 order by t1.${example.orderByClause}
    </if>
  	
  </select>
  
  
  
  <select id="selectPageConfigDtoCountBy" resultType="java.lang.Long">
  	select 
  		count(t1.id) 
  	from
  		t_ctr_page_config t1  		  		
  	LEFT JOIN
  		t_ims_project t2
  	ON
  		t1.project_id = t2.id
  	LEFT JOIN
  		t_ctr_cafetorium t3
  	ON
  		t1.cafetorium_id = t3.cafe_name
  		
  	<if test="example != null" >
      <where >
	      <foreach collection="example.oredCriteria" item="criteria" separator="or" >
	        <if test="criteria.valid" >
	          <trim prefix="(" suffix="" prefixOverrides="and" >
	            <foreach collection="criteria.criteria" item="criterion" >
	              <choose >
	                <when test="criterion.noValue" >
	                  and t1.${criterion.condition}
	                </when>
	                <when test="criterion.singleValue" >
	                  and t1.${criterion.condition} #{criterion.value}
	                </when>
	                <when test="criterion.betweenValue" >
	                  and t1.${criterion.condition} #{criterion.value} and #{criterion.secondValue}
	                </when>
	                <when test="criterion.listValue" >
	                  and t1.${criterion.condition}
	                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
	                    #{listItem}
	                  </foreach>
	                </when>
	              </choose>
	            </foreach>
	          </trim>
	        </if>
	      </foreach>
	      
	      <if test="increment != null">
	      	<choose>
	      		<when test="criteria.valid">
	      			<choose>
			      		<when test="increment.projectName != null and increment.projectName != '' ">
			      			and t2.proj_name like '%${increment.projectName}%'
		      				<choose>
		      					<when test="increment.cafetoriumName != null and increment.cafetoriumName != '' ">
		      						and t3.cafe_name like '%${increment.cafetoriumName}%'
		      					</when>		      					
		      				</choose>
			      		</when>
			      		<otherwise>
			      			<choose>
			      				<when test="increment.cafetoriumName != null and increment.cafetoriumName != '' ">
			      					t3.cafe_name like '%${increment.cafetoriumName}%'
			      				</when>
			      			</choose>
			      		</otherwise>
		      		</choose>
		      		 )
	      		</when>
	      		<otherwise>
		      		<choose>
			      		<when test="increment.projectName != null and increment.projectName != '' ">
			      			t2.proj_name like '%${increment.projectName}%'
		      				<choose>
		      					<when test="increment.cafetoriumName != null and increment.cafetoriumName != '' ">
		      						and t3.cafe_name like '%${increment.cafetoriumName}%'
		      					</when>		      					
		      				</choose>
			      		</when>
			      		<otherwise>
			      			<choose>
			      				<when test="increment.cafetoriumName != null and increment.cafetoriumName != '' ">
			      					t3.cafe_name like '%${increment.cafetoriumName}%'
			      				</when>
			      			</choose>
			      		</otherwise>
		      		</choose>
	      		</otherwise>
	      	</choose>
	      	
	      </if>
	     
      </where>
      
    </if>  		
  	<if test="example.orderByClause != null" >
     	 order by t1.${example.orderByClause}
    </if>
  	
  </select>
 
</mapper>